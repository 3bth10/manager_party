
 {% extends 'index.html' %}

 {% block content %}
       {% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul id="flash-msg" class=flashes>
    {% for message in messages %}
      <li class="text-red-300 text-center mt-10 ">{{ message }} تم الحذف</li>
    {% endfor %}
    </ul>
     <script>
        
        setTimeout(() => {
          const flash = document.getElementById('flash-msg');
          if (flash) {
            flash.classList.add('opacity-0'); 
            setTimeout(() => flash.remove(), 500); // remove after fade
          }
        }, 3000);
      </script>
  {% endif %}
{% endwith %}
 <h1 class="text-4xl font-bold border-b mt-10 text-center p-2 text-orange-400 ">الحفلات</h1>
    
<div class="grid gap-3 grid-cols-1 lg:grid-cols-4 p-5 md:grid-cols-2 sm:grid-cols-2 mb-10">
    {% for party in parties %}
<div class="party-card bg-orange-200 p-6 rounded-xl mt-10 shadow-lg text-black transition-all hover:scale-105"
     data-salary="{{ party.salary }}"
     data-members="{{ party.members }}"
     data-id="{{ party.id }}">

    <h4>قاعة : {{ party.hall }}</h4>
    <p>{{ party.date }} | التاريخ</p>
    <p>عدد المناديب : {{ party.members }}</p>
    <p>المرتب : {{ party.salary }} ريال</p>

    <p class="result font-bold text-blue-800 mt-2"></p>

    <div class="flex gap-3 mt-4">
        <form action="/parties/{{ party.id }}" method="post">
            <button class="bg-orange-300 rounded-lg shadow-lg p-2 hover:bg-orange-500 transition-colors">delete</button>
        </form>

        <form action="/updateparty/{{ party.id }}" method="get">
            <button class="bg-orange-300 rounded-lg shadow-lg p-2 hover:bg-orange-500 transition-colors">Update</button>
        </form>
    </div>
</div>
{% endfor %}
</div>

<script>
    // Get all party cards
        
        document.querySelectorAll('.party-card').forEach(card => {
            if (card.dataset.salary && card.dataset.members){
                const salary = Number(card.dataset.salary);
        const members = Number(card.dataset.members);

        const result = salary / members;

        const resultEl = card.querySelector('.result');
        resultEl.textContent = "نصيب كل مندوب: " + result.toFixed(2) + " ريال";
            }
        
    });
    
  
</script>

{% endblock %}
